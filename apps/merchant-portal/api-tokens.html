<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Tokens - ุจูุงุจุฉ ุงูุชุงุฌุฑ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        .spinner { border: 3px solid #f3f3f3; border-top: 3px solid #f59e0b; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; display: inline-block; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .token-card { transition: all 0.3s; }
        .token-card:hover { box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
        
        .copy-btn { transition: all 0.2s; }
        .copy-btn:hover { background-color: #f3f4f6; }
        .copy-btn.copied { background-color: #dcfce7; color: #16a34a; }
        
        code { font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">

<!-- Main Content -->
<div id="main">
    <!-- Header -->
    <header class="bg-gradient-to-r from-amber-500 to-orange-500 text-white shadow-lg">
        <div class="max-w-4xl mx-auto px-4 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <a href="/merchant/dashboard.html" class="text-white hover:text-amber-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                        </svg>
                    </a>
                    <div>
                        <h1 class="text-2xl font-bold">๐ API Tokens</h1>
                        <p class="text-amber-100 text-sm">ุฅุฏุงุฑุฉ ููุงุชูุญ ุงููุตูู ููู API</p>
                    </div>
                </div>
                <a href="https://docs.healthpay.tech/api" target="_blank" 
                   class="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                    </svg>
                    ุงูุชูุซูู
                </a>
            </div>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-4 py-8">
        <!-- Alert Messages -->
        <div id="successAlert" class="hidden bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-xl mb-6 flex items-center gap-3">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
            </svg>
            <span id="successMessage">ุชู ุจูุฌุงุญ</span>
        </div>

        <!-- Warning Banner -->
        <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-4 mb-6 flex items-start gap-3">
            <svg class="w-6 h-6 text-yellow-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
            </svg>
            <div>
                <h3 class="font-bold text-yellow-800">ุชุญุฐูุฑ ุฃููู</h3>
                <p class="text-yellow-700 text-sm">ูุง ุชุดุงุฑู ููุงุชูุญ API ุงูุฎุงุตุฉ ุจู ูุน ุฃู ุดุฎุต. ูููุญ ุงูููุชุงุญ ูุตููุงู ูุงููุงู ูุญุณุงุจู.</p>
            </div>
        </div>

        <!-- Merchant Info -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
            <div class="flex items-center justify-between">
                <div>
                    <h2 class="text-lg font-bold text-gray-800">ูุนูููุงุช ุงูุชุงุฌุฑ</h2>
                    <p class="text-gray-500 text-sm">ูุนุฑูุงุช ุญุณุงุจู ููุงุณุชุฎุฏุงู ูู ุงูู API</p>
                </div>
            </div>
            
            <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-gray-50 rounded-xl p-4">
                    <label class="text-gray-500 text-sm">Merchant ID</label>
                    <div class="flex items-center gap-2 mt-1">
                        <code class="text-gray-800 text-lg" id="merchantId">MCH_XXXXXXXX</code>
                        <button onclick="copyToClipboard('merchantId')" class="copy-btn p-1 rounded">
                            <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="bg-gray-50 rounded-xl p-4">
                    <label class="text-gray-500 text-sm">Terminal ID</label>
                    <div class="flex items-center gap-2 mt-1">
                        <code class="text-gray-800 text-lg" id="terminalId">TRM_XXXXXXXX</code>
                        <button onclick="copyToClipboard('terminalId')" class="copy-btn p-1 rounded">
                            <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- API Tokens List -->
        <div class="bg-white rounded-2xl shadow-lg overflow-hidden mb-6">
            <div class="px-6 py-4 bg-gray-50 border-b flex items-center justify-between">
                <div>
                    <h2 class="text-lg font-bold text-gray-800">๐ ููุงุชูุญ API</h2>
                    <p class="text-gray-600 text-sm">ุฅุฏุงุฑุฉ ููุงุชูุญ ุงููุตูู</p>
                </div>
                <button onclick="showCreateModal()" 
                    class="bg-amber-500 text-white px-4 py-2 rounded-lg hover:bg-amber-600 transition-colors flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                    </svg>
                    ุฅูุดุงุก ููุชุงุญ ุฌุฏูุฏ
                </button>
            </div>

            <div id="tokensList" class="p-6 space-y-4">
                <!-- Tokens will be rendered here -->
            </div>

            <div id="emptyState" class="hidden text-center py-12">
                <span class="text-6xl">๐</span>
                <h3 class="text-xl font-bold text-gray-800 mt-4">ูุง ุชูุฌุฏ ููุงุชูุญ API</h3>
                <p class="text-gray-500 mt-2">ูู ุจุฅูุดุงุก ููุชุงุญ API ููุจุฏุก ูู ุงูุฏูุฌ</p>
                <button onclick="showCreateModal()" 
                    class="mt-4 bg-amber-500 text-white px-6 py-3 rounded-xl hover:bg-amber-600 transition-colors">
                    ุฅูุดุงุก ููุชุงุญ ุฌุฏูุฏ
                </button>
            </div>
        </div>

        <!-- API Usage Stats -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
            <h2 class="text-lg font-bold text-gray-800 mb-4">๐ ุฅุญุตุงุฆูุงุช ุงูุงุณุชุฎุฏุงู</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="bg-blue-50 rounded-xl p-4 text-center">
                    <p class="text-blue-600 text-2xl font-bold" id="totalCalls">0</p>
                    <p class="text-gray-600 text-sm">ุทูุจุงุช ูุฐุง ุงูุดูุฑ</p>
                </div>
                <div class="bg-green-50 rounded-xl p-4 text-center">
                    <p class="text-green-600 text-2xl font-bold" id="successRate">0%</p>
                    <p class="text-gray-600 text-sm">ูุณุจุฉ ุงููุฌุงุญ</p>
                </div>
                <div class="bg-yellow-50 rounded-xl p-4 text-center">
                    <p class="text-yellow-600 text-2xl font-bold" id="avgLatency">0ms</p>
                    <p class="text-gray-600 text-sm">ูุชูุณุท ุงูุงุณุชุฌุงุจุฉ</p>
                </div>
                <div class="bg-purple-50 rounded-xl p-4 text-center">
                    <p class="text-purple-600 text-2xl font-bold" id="rateLimit">1000</p>
                    <p class="text-gray-600 text-sm">ุญุฏ ุงูุทูุจุงุช/ุฏูููุฉ</p>
                </div>
            </div>
        </div>

        <!-- Quick Start Guide -->
        <div class="bg-white rounded-2xl shadow-lg p-6">
            <h2 class="text-lg font-bold text-gray-800 mb-4">๐ ุฏููู ุงูุจุฏุก ุงูุณุฑูุน</h2>
            
            <div class="space-y-4">
                <div class="bg-gray-900 rounded-xl p-4 overflow-x-auto">
                    <p class="text-gray-400 text-sm mb-2"># ุทูุจ ูุตุงุฏูุฉ</p>
                    <code class="text-green-400 text-sm">
curl -X POST https://api.healthpay.tech/v1/auth \
  -H "Content-Type: application/json" \
  -d '{"api_key": "YOUR_API_KEY", "api_secret": "YOUR_API_SECRET"}'
                    </code>
                </div>
                
                <div class="bg-gray-900 rounded-xl p-4 overflow-x-auto">
                    <p class="text-gray-400 text-sm mb-2"># ุฅูุดุงุก ุทูุจ ุฏูุน</p>
                    <code class="text-green-400 text-sm">
curl -X POST https://api.healthpay.tech/v1/payments \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"amount": 100.00, "currency": "EGP", "description": "Payment for Order #123"}'
                    </code>
                </div>
            </div>
            
            <a href="https://docs.healthpay.tech/api" target="_blank" 
               class="inline-block mt-4 text-amber-600 hover:text-amber-700 font-medium">
                ุนุฑุถ ุงูุชูุซูู ุงููุงูู โ
            </a>
        </div>
    </main>
</div>

<!-- Create Token Modal -->
<div id="createModal" class="hidden fixed inset-0 z-50">
    <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeCreateModal()"></div>
    <div class="absolute inset-0 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-6 max-w-md w-full">
            <h3 class="text-lg font-bold text-gray-800 mb-4">๐ ุฅูุดุงุก ููุชุงุญ API ุฌุฏูุฏ</h3>
            
            <div class="mb-4">
                <label class="block text-gray-700 font-medium mb-2">ุงุณู ุงูููุชุงุญ</label>
                <input type="text" id="tokenName" 
                    class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-amber-500 focus:border-transparent"
                    placeholder="ูุซุงู: ุชุทุจูู ุงูููุจุงูู">
            </div>
            
            <div class="mb-4">
                <label class="block text-gray-700 font-medium mb-2">ุงูุตูุงุญูุงุช</label>
                <div class="space-y-2">
                    <label class="flex items-center gap-2">
                        <input type="checkbox" id="permRead" checked class="w-4 h-4 rounded">
                        <span class="text-gray-700">ูุฑุงุกุฉ (Read)</span>
                    </label>
                    <label class="flex items-center gap-2">
                        <input type="checkbox" id="permWrite" checked class="w-4 h-4 rounded">
                        <span class="text-gray-700">ูุชุงุจุฉ (Write)</span>
                    </label>
                    <label class="flex items-center gap-2">
                        <input type="checkbox" id="permRefund" class="w-4 h-4 rounded">
                        <span class="text-gray-700">ุงุณุชุฑุฏุงุฏ (Refund)</span>
                    </label>
                </div>
            </div>
            
            <div class="mb-6">
                <label class="block text-gray-700 font-medium mb-2">ุชุงุฑูุฎ ุงูุงูุชูุงุก</label>
                <select id="tokenExpiry" class="w-full px-4 py-3 border border-gray-300 rounded-xl">
                    <option value="never">ูุง ููุชูู</option>
                    <option value="30">30 ููู</option>
                    <option value="90">90 ููู</option>
                    <option value="365">ุณูุฉ</option>
                </select>
            </div>
            
            <div class="flex gap-3">
                <button onclick="closeCreateModal()" class="flex-1 py-3 bg-gray-100 rounded-xl font-medium text-gray-600">
                    ุฅูุบุงุก
                </button>
                <button onclick="createToken()" class="flex-1 py-3 bg-amber-500 text-white rounded-xl font-medium">
                    ุฅูุดุงุก ุงูููุชุงุญ
                </button>
            </div>
        </div>
    </div>
</div>

<!-- New Token Modal -->
<div id="newTokenModal" class="hidden fixed inset-0 z-50">
    <div class="absolute inset-0 bg-black/50 backdrop-blur-sm"></div>
    <div class="absolute inset-0 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-6 max-w-lg w-full">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-3xl">โ</span>
                </div>
                <h3 class="text-lg font-bold text-gray-800">ุชู ุฅูุดุงุก ุงูููุชุงุญ ุจูุฌุงุญ!</h3>
                <p class="text-red-600 text-sm mt-2">โ๏ธ ูุฐุง ูู ุงูููุช ุงููุญูุฏ ุงูุฐู ุณุชุชููู ููู ูู ุฑุคูุฉ ุงูููุชุงุญ ุงูุณุฑู</p>
            </div>
            
            <div class="space-y-4 mb-6">
                <div class="bg-gray-50 rounded-xl p-4">
                    <label class="text-gray-500 text-sm">API Key</label>
                    <div class="flex items-center gap-2 mt-1">
                        <code class="text-gray-800 text-sm flex-1 break-all" id="newApiKey">-</code>
                        <button onclick="copyToClipboard('newApiKey')" class="copy-btn p-2 rounded">
                            <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="bg-red-50 rounded-xl p-4 border border-red-200">
                    <label class="text-red-600 text-sm font-medium">API Secret (ุงุญูุธู ุงูุขู!)</label>
                    <div class="flex items-center gap-2 mt-1">
                        <code class="text-red-800 text-sm flex-1 break-all" id="newApiSecret">-</code>
                        <button onclick="copyToClipboard('newApiSecret')" class="copy-btn p-2 rounded">
                            <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            
            <button onclick="closeNewTokenModal()" class="w-full py-3 bg-amber-500 text-white rounded-xl font-medium">
                ูููุชุ ููุฏ ุญูุธุช ุงูููุชุงุญ
            </button>
        </div>
    </div>
</div>

<!-- Revoke Confirm Modal -->
<div id="revokeModal" class="hidden fixed inset-0 z-50">
    <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeRevokeModal()"></div>
    <div class="absolute inset-0 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-6 max-w-md w-full">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-3xl">โ๏ธ</span>
                </div>
                <h3 class="text-lg font-bold text-gray-800">ุฅูุบุงุก ุงูููุชุงุญุ</h3>
                <p class="text-gray-600 text-sm mt-2">ุณูุชู ุฅุจุทุงู ูุฐุง ุงูููุชุงุญ ููุฑุงู ููู ุชุชููู ุงูุชุทุจููุงุช ูู ุงุณุชุฎุฏุงูู.</p>
            </div>
            
            <div class="flex gap-3">
                <button onclick="closeRevokeModal()" class="flex-1 py-3 bg-gray-100 rounded-xl font-medium text-gray-600">
                    ุฅูุบุงุก
                </button>
                <button onclick="confirmRevoke()" class="flex-1 py-3 bg-red-600 text-white rounded-xl font-medium">
                    ุฅูุบุงุก ุงูููุชุงุญ
                </button>
            </div>
        </div>
    </div>
</div>

<script>
// Mock data
let tokens = [
    {
        id: 'tok_1',
        name: 'ุชุทุจูู ุงูููุจุงูู',
        apiKey: 'hp_live_aBc123XyZ456',
        permissions: ['read', 'write'],
        createdAt: '2025-12-01T10:00:00',
        lastUsed: '2025-12-26T14:30:00',
        status: 'active'
    },
    {
        id: 'tok_2',
        name: 'ูููุน ุงูููุจ',
        apiKey: 'hp_live_DeF789QwE012',
        permissions: ['read', 'write', 'refund'],
        createdAt: '2025-11-15T08:00:00',
        lastUsed: '2025-12-25T09:15:00',
        status: 'active'
    }
];

let revokingTokenId = null;

// Initialize
function init() {
    // Generate merchant IDs
    document.getElementById('merchantId').textContent = 'MCH_' + generateId(8);
    document.getElementById('terminalId').textContent = 'TRM_' + generateId(8);
    
    // Load stats
    document.getElementById('totalCalls').textContent = '12,458';
    document.getElementById('successRate').textContent = '99.2%';
    document.getElementById('avgLatency').textContent = '45ms';
    
    renderTokens();
}

function generateId(length) {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    let result = '';
    for (let i = 0; i < length; i++) {
        result += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return result;
}

// Render tokens list
function renderTokens() {
    const container = document.getElementById('tokensList');
    const emptyState = document.getElementById('emptyState');
    
    if (tokens.length === 0) {
        container.innerHTML = '';
        emptyState.classList.remove('hidden');
        return;
    }
    
    emptyState.classList.add('hidden');
    
    container.innerHTML = tokens.map(token => `
        <div class="token-card border rounded-xl p-4">
            <div class="flex items-center justify-between mb-3">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center">
                        <span class="text-xl">๐</span>
                    </div>
                    <div>
                        <h3 class="font-bold text-gray-800">${token.name}</h3>
                        <p class="text-gray-500 text-sm">ุฃููุดุฆ ูู ${formatDate(token.createdAt)}</p>
                    </div>
                </div>
                <span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm">ูุดุท</span>
            </div>
            
            <div class="bg-gray-50 rounded-lg p-3 mb-3">
                <div class="flex items-center justify-between">
                    <code class="text-gray-600 text-sm">${maskKey(token.apiKey)}</code>
                    <button onclick="copyKey('${token.apiKey}')" class="copy-btn p-1 rounded text-sm text-amber-600">
                        ูุณุฎ
                    </button>
                </div>
            </div>
            
            <div class="flex items-center justify-between text-sm">
                <div class="flex items-center gap-4">
                    <span class="text-gray-500">
                        ุขุฎุฑ ุงุณุชุฎุฏุงู: ${token.lastUsed ? formatRelativeTime(token.lastUsed) : 'ูู ููุณุชุฎุฏู'}
                    </span>
                    <span class="text-gray-400">|</span>
                    <span class="text-gray-500">
                        ุงูุตูุงุญูุงุช: ${token.permissions.join(', ')}
                    </span>
                </div>
                <button onclick="showRevokeModal('${token.id}')" class="text-red-600 hover:text-red-700">
                    ุฅูุบุงุก
                </button>
            </div>
        </div>
    `).join('');
}

function maskKey(key) {
    return key.substring(0, 12) + 'โขโขโขโขโขโขโขโขโขโขโขโข';
}

function formatDate(dateString) {
    return new Date(dateString).toLocaleDateString('ar-EG', {
        year: 'numeric',
        month: 'short',
        day: 'numeric'
    });
}

function formatRelativeTime(dateString) {
    const date = new Date(dateString);
    const now = new Date();
    const diffMs = now - date;
    const diffHours = Math.floor(diffMs / 3600000);
    const diffDays = Math.floor(diffMs / 86400000);
    
    if (diffHours < 1) return 'ููุฐ ุฏูุงุฆู';
    if (diffHours < 24) return `ููุฐ ${diffHours} ุณุงุนุฉ`;
    if (diffDays < 7) return `ููุฐ ${diffDays} ููู`;
    return formatDate(dateString);
}

// Copy to clipboard
function copyToClipboard(elementId) {
    const text = document.getElementById(elementId).textContent;
    navigator.clipboard.writeText(text);
    showSuccess('ุชู ุงููุณุฎ!');
}

function copyKey(key) {
    navigator.clipboard.writeText(key);
    showSuccess('ุชู ูุณุฎ ุงูููุชุงุญ!');
}

// Create token modal
function showCreateModal() {
    document.getElementById('createModal').classList.remove('hidden');
}

function closeCreateModal() {
    document.getElementById('createModal').classList.add('hidden');
    document.getElementById('tokenName').value = '';
}

function createToken() {
    const name = document.getElementById('tokenName').value.trim();
    if (!name) {
        alert('ูุฑุฌู ุฅุฏุฎุงู ุงุณู ููููุชุงุญ');
        return;
    }
    
    const permissions = [];
    if (document.getElementById('permRead').checked) permissions.push('read');
    if (document.getElementById('permWrite').checked) permissions.push('write');
    if (document.getElementById('permRefund').checked) permissions.push('refund');
    
    // Generate new token
    const newToken = {
        id: 'tok_' + Date.now(),
        name: name,
        apiKey: 'hp_live_' + generateId(16),
        apiSecret: 'hp_secret_' + generateId(32),
        permissions: permissions,
        createdAt: new Date().toISOString(),
        lastUsed: null,
        status: 'active'
    };
    
    tokens.unshift(newToken);
    
    // Show the new token
    document.getElementById('newApiKey').textContent = newToken.apiKey;
    document.getElementById('newApiSecret').textContent = newToken.apiSecret;
    
    closeCreateModal();
    document.getElementById('newTokenModal').classList.remove('hidden');
    
    renderTokens();
}

function closeNewTokenModal() {
    document.getElementById('newTokenModal').classList.add('hidden');
}

// Revoke token
function showRevokeModal(tokenId) {
    revokingTokenId = tokenId;
    document.getElementById('revokeModal').classList.remove('hidden');
}

function closeRevokeModal() {
    document.getElementById('revokeModal').classList.add('hidden');
    revokingTokenId = null;
}

function confirmRevoke() {
    if (!revokingTokenId) return;
    
    tokens = tokens.filter(t => t.id !== revokingTokenId);
    closeRevokeModal();
    renderTokens();
    showSuccess('ุชู ุฅูุบุงุก ุงูููุชุงุญ ุจูุฌุงุญ');
}

// Show success
function showSuccess(message) {
    document.getElementById('successMessage').textContent = message;
    document.getElementById('successAlert').classList.remove('hidden');
    setTimeout(() => document.getElementById('successAlert').classList.add('hidden'), 3000);
}

// Initialize on load
init();
</script>

</body>
</html>
